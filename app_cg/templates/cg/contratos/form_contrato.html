{% extends 'cg/base.html' %}
{% block conteudo %}

<div id="cards" class="content">
    <div class="container-sm py-4">
        <div class="card shadow-sm border-0">
            <div class="card-header text-center rounded-top">
                <h3 class="mb-0">Novo Documento</h3>
                <h5 class="fw-bold mt-2">{{ nometemplate }}</h5>
            </div>

            <div class="card-body bg-light">
                <form id="myForm" method="post" enctype="multipart/form-data" action="{% url 'cadastrar_contrato' %}">
                    {% csrf_token %}

                    <!-- Formulário dinâmico -->
                    <div class="mb-3">
                        {{ formulario|safe }}
                    </div>

                    <!-- Campo oculto -->
                    <input id="codtemplate" name="codtemplate" type="hidden" value="{{ codtemplate }}">

                    <hr class="mx-auto my-4" style="width: 60px; border-top: 2px solid #007bff;">

                    <!-- Botões -->
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div class="bottom-0 start-0 end-0 p-3 bg-light" style="z-index: 1050;">
                            <button onclick="history.back()" type="button" class="btn btn-secondary"><i class="fas fa-reply"></i> Voltar</button>                
                        </div>

                        {% if possui_variavel == 1 %}
                        <button type="submit" class="btn btn-primary" id="btn_salvar" form="myForm">
                            <i class="fas fa-save me-1"></i> Salvar Documento
                        </button>
                        {% else %}
                        <button class="btn btn-primary" disabled>
                            <i class="fas fa-save me-1"></i> Salvar Documento
                        </button>
                        {% endif %}
                    </div>
                </form>
            </div>

            <div class="card-footer text-muted text-center small">
                <em>Verifique todos os campos antes de salvar o documento.</em>
            </div>
        </div>
    </div>
</div>

<script>
    /////////// Validar Obrigatoriedade do nome do arquivo
    function validarNome() {
        var name = $('#nome_arquivo_finale').val();

        if (name === '') {
            $('#nome-erro').show();
            $('#nome_arquivo_finale').addClass('is-invalid')
            // $('#nome_arquivo_finale').attr('required', true);
            return false;1
        } else {
            $('#nome-erro').hide();
            $('#nome_arquivo_finale').removeClass('is-invalid').addClass('is-valid');
            // $('#nome_arquivo_finale').attr('required', true);
            return true;
        }
    }
    $(document).ready(function () {
        // Enquanto digita
        $('#nome_arquivo_finale').on('input', function () {
            validarNome();
        });

        // Validação inicial
        validarNome();
    });
</script>
{% endblock %}